<!doctype html>
<html>
    <head>
        <title>Mobile Web APIs</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="author" content="Thomas A. Valletta" />
        <meta name="author" content="Gabriel Dayley" />
        <link href="css/impress.css" rel="stylesheet" />
        <link href="css/prettify.css" rel="stylesheet" />
        <script type="text/javascript" src='js/jquery-1.8.2.min.js'></script>
        <script type="text/javascript" src='js/prettify.js'></script>
	    <script src="/socket.io/socket.io.js"></script>
        <style type="text/css">
        	pre.prettyprint {
				font-family: "Courier New", Monaco, "Lucida Console", monospace;
				font-weight: bold;
        	}
        	div.remote {
        		opacity: 0;
			    -webkit-transition: .5s;
			    -moz-transition:    .5s;
			    -ms-transition:     .5s;
			    -o-transition:      .5s;
			    transition:         .5s;

        		height: 150px;
        		width: 600px;
        		position: fixed;
        		top: 20px;
        		right: 20px;

        		text-align: right;
        		font-size: 72px;
        	}
        	div.remote.show {
        		opacity: 0.7;
        	}
        	div.video {
        		opacity: 0;
			    -webkit-transition: .5s;
			    -moz-transition:    .5s;
			    -ms-transition:     .5s;
			    -o-transition:      .5s;
			    transition:         .5s;

			    background-color: rgba(0, 0, 0, 0.8);

        		height: 100%;
        		width: 100%;
        		position: fixed;
        		top: 0px;
        		left: 0px;

        		text-align: center;
        		font-size: 72px;
        		z-index: 1;
        	}
        	div.video.show {
        		opacity: 1;
        	}
        	div.screen {
        		background-color: blue;
        		width: 800px;
        		height: 600px;
        		margin: 8% auto;
        	}
        </style>
    </head>
    <body onload='prettyPrint()'>
    	<div class='remote'></div>
    	<div class='video'>
	    	<div class='screen'></div>
    	</div>
		<p class="fallback-message">
		    Your browser doesn't support impress.js.  Try Chrome or Safari.
		</p>
		<div id="impress" ondblclick="enterFullScreen()">
			<div id="title" class="step" data-x="600" data-y="0" data-z="-500" data-rotate-y="-75">
			    <h1>Mobile Web APIs</h1>
			    <h4>By Gabriel Dayley &amp; Thomas A. Valletta</h4>
			</div>
			<div class="step" data-x="0" data-y="0" data-z="0">
				<h2>Intro</h2>
			</div>
			<div class="step" data-x="50" data-y="100" data-z="-100">
				<h4>Gabriel Dayley</h4>
			</div>
			<div class="step" data-x="50" data-y="200" data-z="-100">
				<h4>Thomas A. Valletta</h4>
			</div>
			<div class="step" data-x="0" data-y="800" data-z="">
				<h2>Mobile Web APIs</h2>
			</div>
			<div class="step" data-x="0" data-y="1600" data-z="">
				
			</div>
			<div class="step" data-x="100" data-y="1100" data-z="-800" data-scale=".8" data-focus='ambient'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1058" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -160px; font-size: 36px'>
window.addEventListener('devicelight', function(e) {
  alert(e.value);
});
</pre>
			</div>
			<div class="step" data-x="100" data-y="1173" data-z="-800" data-scale=".8" data-focus='archive'>
			
			</div>
			<div class="step" data-x="426.5" data-y="1131" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -140px; font-size: 36px'>
var blob = ...;
var reader = ArchiveReader(blob);
 
var h = reader.getFilenames();
h.onerror = function() { ... }
h.onsuccess = function() {
  for (var i = 0; i < this.result.length; ++i) {
    something(this.result[i]);
  }
}
</pre>	
			</div>
			<div class="step" data-x="100" data-y="1246" data-z="-800" data-scale=".8" data-focus='battery'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1204" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -180px; font-size: 32px'>
navigator.mozBattery.onlevelchange = function() {
	alert(battery.level);
}
navigator.mozBattery.onchargingchange = function() {
	alert(battery.charging);
}
navigator.mozBattery.ondischargingtimechange = function() {
	alert(battery.dischargingTime);
}
</pre>
			</div>
			<div class="step" data-x="100" data-y="1319" data-z="-800" data-scale=".8" data-focus='geolocation'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1277" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -200px; font-size: 36px'>
navigator.geolocation.getCurrentPosition(function() {
  latitude = position.coords.latitude;
  longitude = position.coords.longitude;
  accuracy = position.coords.accuracy;	
});
</pre>
			</div>
			<div class="step" data-x="100" data-y="1392" data-z="-800" data-scale=".8" data-focus='file'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1350" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -40px; font-size: 36px'>
var lockedFile = myFile.open();
var request = lockedFile.readAsText(3);
request.onsuccess = function(event) {
  var text = event.target.result;
  // 3 characters have been read.
}
</pre>
			</div>
			<div class="step" data-x="100" data-y="1465" data-z="-800" data-scale=".8" data-focus='idle'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1423" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js'>
navigator.addIdleObserver({
  time: 10, // seconds
  onidle: idleHandler, // fn
  onactive: activeHandler // fn
});
</pre>
			</div>
			<div class="step" data-x="100" data-y="1538" data-z="-800" data-scale=".8" data-focus='indexed'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1496" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -140px; font-size: 36px'>
var request = indexedDB.open('AddressBook', 15);
request.onsuccess = function(evt) {...};
request.onerror = function(evt) {...};
</pre>
			</div>
			<div class="step" data-x="100" data-y="1611" data-z="-800" data-scale=".8" data-focus='media'>
				
			</div>
			<div class="step invisible" data-x="-100" data-y="1611" data-z="-800" data-scale=".8" data-rotate-y="90" data-focus='media'>
				<h2>Media Capture</h2>
<pre class='prettyprint lang-js' style='position: relative; left: -80px; font-size: 28px'>
&lt;input type="file" accept="image/*;capture=camera"&gt;
&lt;input type="file" accept="video/*;capture=camcorder"&gt;
&lt;input type="file" accept="audio/*;capture=microphone"&gt;
</pre>
			</div>
<!-- 			
			<div class="step" data-x="426.5" data-y="1569" data-z="-800" data-scale=".08">
			</div>
 -->				
			<div class="step invisible" data-x="-300" data-y="1611" data-z="-800" data-scale=".8" data-rotate-y="90" data-focus='media'>
 				<h2>Get User Media</h2>
<pre class='prettyprint lang-js' style='position: relative; left: -140px; font-size: 28px'>
navigator.getUserMedia = navigator.getUserMedia || 
    navigator.webkitGetUserMedia ||
    navigator.mozGetUserMedia || 
    navigator.msGetUserMedia;
window.URL = window.URL || window.webkitURL;

navigator.getUserMedia({video: true}, function(localMediaStream) {
  var video = document.createElement("video");
  video.autoplay = true;
  video.src = window.URL.createObjectURL(localMediaStream);
  document.body.appendChild(video);
}, function(error) {
  console.log(error);
});
</pre>
			</div>
			<div class="step invisible" data-x="-500" data-y="1611" data-z="-800" data-scale=".8" data-rotate-y="90" data-focus='media'>
				<h2>WebRTC</h2>
				<h4>Real-time communication without plugins</h4>
			</div>
			<div class="step invisible" data-x="-700" data-y="1611" data-z="-800" data-scale=".8" data-rotate-y="90" data-focus='media'>
				<img src='img/webrtc.jpg'/>
				<ul style='font-size: 36px; list-style: disc'>
					<li>Get streaming audio and video</li>
					<li>Communicate streaming audio, video, or data</li>
					<li>Exchange control messages to initiate or control sessions.</li>
					<li>Exchange information about media (resolution, format)</li>
				</ul>
			</div>
			<div class="step" data-x="100" data-y="1684" data-z="-800" data-scale=".8" data-focus='mouse'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1642" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js'>
elem.requestPointerLock = 
  elem.requestPointerLock ||
  elem.mozRequestPointerLock ||
  elem.webkitRequestPointerLock;
elem.requestPointerLock();
</pre>
			</div>
			<div class="step" data-x="100" data-y="1757" data-z="-800" data-scale=".8" data-focus='network'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1715" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -160px; font-size: 36px'>
var connection = navigator.mozConnection;
connection.addEventListener('change', function() {
  alert(connection.bandwidth);
});
</pre>
			</div>
			<div class="step" data-x="100" data-y="1830" data-z="-800" data-scale=".8" data-focus='open'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1788" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js'>
navigator.mozApps.install();
navigator.mozApps.getSelf();
navigator.mozApps.getInstalled();
</pre>
			</div>
			<div class="step" data-x="100" data-y="1903" data-z="-800" data-scale=".8" data-focus='proximity'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1861" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -150px; font-size: 36px'>
window.addEventListener("userproximity", fn, true);
function fn(event) {
  if (event.near) 
    console.log("Near");
  else
    console.log("Far");
}
</pre>
			</div>
			<div class="step" data-x="100" data-y="1976" data-z="-800" data-scale=".8" data-focus='screen'>
				
			</div>
			<div class="step" data-x="426.5" data-y="1934" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -120px; font-size: 32px'>
window.addEventListener(orientationEvent, function() {
    alert(window.orientation);
}, false);

// Recently Added 
screen.lockOrientation('portrait-primary');
screen.unlockOrientation();
</pre>
			</div>
			<div class="step" data-x="100" data-y="2049" data-z="-800" data-scale=".8" data-focus='sms'>
				
			</div>
			<div class="step" data-x="426.5" data-y="2007" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -140px; font-size: 36px'>
// Done but not shipped :(
window.addEventListener('smsevent', function(e) {
  switch(e.type) {
    case 'smssent': ...
    case 'smsdelivered': ...
    case 'smsreceived': ...
  }
});
</pre>
			</div>
			<div class="step" data-x="100" data-y="2122" data-z="-800" data-scale=".8" data-focus='time'>
				
			</div>
			<div class="step" data-x="426.5" data-y="2080" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js'>
// Based on the proposal
var clock = navigator.timeManager;
clock.set(date); // Date Object
clock.set(ticks); // POSIX time
</pre>
			</div>
			<div class="step" data-x="100" data-y="2195" data-z="-800" data-scale=".8" data-focus='telephony'>
				
			</div>
			<div class="step" data-x="426.5" data-y="2153" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -180px; font-size: 36px'>
var call = navigator.mozTelephony.dial("8012401000");
call.addEventListener('readystatechange', function() {
	console.log('readyState');
})

navigator.mozTelephony.addEventListener('incoming', 
  function(event)) {
    call = navigator.mozTelephony.liveCalls[0];
    console.log('Call from: ' + call.number);
  }
);
</pre>
			</div>
			<div class="step" data-x="100" data-y="2268" data-z="-800" data-scale=".8" data-focus='vibration'>
				
			</div>
			<div class="step" data-x="426.5" data-y="2226" data-z="-800" data-scale=".08">
<pre class='prettyprint lang-js' style='position: relative; left: -100px'>
navigator.mozVibrate(600);
navigator.mozVibrate([50, 100, 200]);
navigator.mozVibrate(0);
</pre>
			</div>
			<div class="step" data-x="0" data-y="1600" data-z=""></div>
			<div class="step clarify" data-x="0" data-y="1600" data-z="-800">
		    	<table cellspacing="4">
		    		<tbody>
			    		<tr class='header'>
			    			<td></td>
			    			<td>Desktop</td>
			    			<td>Mobile</td>
			    			<td>Detail</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='ambient'>
			    			<td class='title'>Ambient Light Sensor</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td>&nbsp;</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='archive'>
			    			<td class='title'>Archive</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td>&nbsp;</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='battery'>
			    			<td class='title'>*Battery</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td>&nbsp;</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='geolocation'>
			    			<td class='title'>*Geolocation</td>
			    			<td></td>
			    			<td>√</td>
			    			<td>&nbsp;</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='file'>
			    			<td class='title'>File Handle</td>
			    			<td></td>
			    			<td>√</td>
			    			<td>&nbsp;</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='idle'>
			    			<td class='title'>Idle</td>
			    			<td>√</td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='indexed'>
			    			<td class='title'>Indexed DB</td>
			    			<td></td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='media'>
			    			<td class='title'>Media</td>
			    			<td>√</td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='mouse'>
			    			<td class='title'>Mouse Lock</td>
			    			<td>√</td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='network'>
			    			<td class='title'>*Network Info</td>
			    			<td>√</td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='open'>
			    			<td class='title'>Open WebApps</td>
			    			<td>√</td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='proximity'>
			    			<td class='title'>Proximity Sensor</td>
			    			<td></td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='screen'>
			    			<td class='title'>*Screen Orientation</td>
			    			<td></td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='sms'>
			    			<td class='title'>SMS</td>
			    			<td></td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='time'>
			    			<td class='title'>Time/Clock</td>
			    			<td></td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='telephony'>
			    			<td class='title'>Telephony</td>
			    			<td></td>
			    			<td>√</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='vibration'>
			    			<td class='title'>Vibration</td>
			    			<td></td>
			    			<td>√</td>
			    		</tr>
			    	</tbody>
		    	</table>
			</div>

			<div class="step" data-x="0" data-y="3400" data-z=""></div>
			<div class="step clarify" data-x="0" data-y="3400" data-z="-800">
		    	<table>
		    		<tbody>
			    		<tr class='header'>
			    			<td></td>
			    			<td>Desktop</td>
			    			<td>Mobile</td>
			    			<td>Detail</td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Alarm</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Bluetooth</td>
			    			<td></td>
			    			<td></td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Browser</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Contacts</td>
			    			<td></td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Device Storage</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Mobile Connection</td>
			    			<td></td>
			    			<td></td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Permissions</td>
			    			<td></td>
			    			<td></td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Power Management</td>
			    			<td></td>
			    			<td></td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='c'>
			    			<td class='title'>Push Notifications</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='d'>
			    			<td class='title'>Settings</td>
			    			<td></td>
			    			<td></td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='d'>
			    			<td class='title'>TCP Socket</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='d'>
			    			<td class='title'>Web Activities</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='d'>
			    			<td class='title'>Web FM</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='d'>
			    			<td class='title'>Web Payments</td>
			    			<td></td>
			    			<td></td>
			    			<td></td>
			    		</tr>
			    		<tr class='focus' data-focus-id='d'>
			    			<td class='title'>WiFi Information</td>
			    			<td>√</td>
			    			<td>√</td>
			    			<td></td>
			    		</tr>
			    	</tbody>
		    	</table>
			</div>


			<div  class="step" data-x="200" data-y="800" data-z="300" data-rotate-y="10">

			</div>
 			<div class="step invisible" data-x="-250" data-y="300" data-rotate-x="20" data-rotate-y="-50" data-rotate-z="70" data-scale="1">
			    <br/><br/><br/><br/><br/>
			    <h6>Thanks!</h6>
			</div>
		</div>
    <script type="text/javascript" src="js/impress.js"></script>
    <script>
    	var $remote = $('.remote');
    	var timer = null;

        document.addEventListener('DOMContentLoaded', function () {
            socket = io.connect('http://localhost');

            socket.on('remote', function(data) {
                $remote.text(data);

                if (timer) clearTimeout(timer);
                if (!$remote.hasClass('show'))
	                $remote.addClass('show');

                timer = setTimeout(function() {
                	$remote.removeClass('show');
                }, 5000)
            });
        });

    	var el = document.getElementById("impress");
    	impress().init();

    	var focusList = [];

    	el.addEventListener("impress:stepenter", function (event) {
    		var focus = $(event.target).attr('data-focus');
    		if (focus) {
    			var $target = $('.focus[data-focus-id="' + focus + '"]');
    			if ($target[0]) {
	    			$target.addClass('clarify');
	    			focusList.push($target);
    			}
    		}
        }, false);

    	el.addEventListener("impress:stepleave", function (event) {
    		for (var i = 0, cnt = focusList.length; i < cnt; i++) {
    			focusList[i].removeClass('clarify');
    		}
    		focusList = [];
        }, false);

    	$(document).bind('keypress', function(e) {
    		if (e.keyCode === 102) {
    			$('#impress')[0].webkitRequestFullScreen();
    		}
    		else if (e.keyCode === 118) {
    			var $vid = $('.video');
    			if ($vid.hasClass('show')) {
    				$vid.removeClass('show');
    			}
    			else {
    				$vid.addClass('show');
    			}
    		}
    	});

    	function enterFullScreen() {
		    remote.webkitRequestFullScreen();
		}

    </script>
    </body>
</html>